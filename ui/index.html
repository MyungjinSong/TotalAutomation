<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÌÜµÌï©ÏûêÎèôÌôî</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Custom Title Bar -->
    <div id="title-bar">
        <div id="title-drag-area">
            <span id="app-title">ÌÜµÌï©ÏûêÎèôÌôî v3.0</span>
        </div>
        <div id="window-controls">
            <div class="control-btn" id="btn-min" onclick="window.minimizeWindow()">
                <svg viewBox="0 0 10 1">
                    <path d="M0 0h10v1H0z" />
                </svg>
            </div>
            <div class="control-btn close-btn" id="btn-close" onclick="window.closeWindow()">
                <svg viewBox="0 0 10 10">
                    <path d="M0 0l10 10M10 0L0 10" stroke="currentColor" stroke-width="1.2" />
                </svg>
            </div>
        </div>
    </div>

    <!-- Login Container -->
    <div id="login-container">

        <!-- View 1: User Selection -->
        <div id="login-view" class="login-card">
            <h2>ÏÇ¨Ïö©Ïûê ÏÑ†ÌÉù</h2>
            <div id="user-list-container">
                <!-- Javascript populated -->
            </div>
            <div class="login-footer">
                <button id="btn-next" class="primary-btn" onclick="moveToPasswordView()"
                    style="width:100%; margin-bottom:10px;" disabled>Îã§Ïùå</button>
                <div style="display:flex; gap:10px; width:100%;">
                    <button class="secondary-btn small" onclick="switchView('add')" style="flex:1;">+ ÏÉà ÏÇ¨Ïö©Ïûê</button>
                    <button id="btn-delete" class="secondary-btn small danger" onclick="deleteUser()" style="flex:1;"
                        disabled>ÏÇ≠Ï†ú</button>
                </div>
            </div>
        </div>

        <!-- View 1.5: Password Entry (Modal-like) -->
        <div id="password-view" class="login-card" style="display: none; position: relative;">
            <button class="icon-back-btn" onclick="backToUserList()" title="Îí§Î°úÍ∞ÄÍ∏∞">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" fill="currentColor" />
                </svg>
            </button>

            <h2 id="pwd-user-name" style="margin-top: 20px;">User Name</h2>
            <p id="pwd-user-id" style="text-align:center; color:#666; margin-top:-10px;">(User ID)</p>

            <div class="login-input-area" style="width: 100%; margin: 20px 0;">
                <input type="password" id="login-pw2" placeholder="2Ï∞® ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" class="full-width-input"
                    onkeydown="handleLoginKey(event)">
            </div>

            <div class="login-actions" style="justify-content: center; display: flex;">
                <button class="primary-btn" onclick="tryLogin()" style="width: 100%;">Î°úÍ∑∏Ïù∏</button>
            </div>
        </div>

        <!-- View 2: Add User (Registration) -->
        <div id="add-user-view" style="display: none;">
            <h3>ÏÉà ÏÇ¨Ïö©Ïûê Îì±Î°ù</h3>
            <div class="form-row">
                <div class="form-group"><label>Ïù¥Î¶Ñ *</label><input type="text" id="new-name"></div>
                <div class="form-group"><label>ÏÇ¨Î≤à *</label><input type="text" id="new-id" maxlength="6"></div>
            </div>

            <div class="form-group"><label>Í∑ºÎ¨¥Ï°∞</label>
                <select id="new-team" style="width: 100%;">
                    <option>AÏ°∞</option>
                    <option>BÏ°∞</option>
                    <option>CÏ°∞</option>
                    <option>DÏ°∞</option>
                    <option>ÏùºÍ∑º</option>
                </select>
            </div>

            <div class="form-row">
                <div class="form-group"><label>ÌÜµÌï© PW *</label><input type="password" id="new-webpw"></div>
                <div class="form-group"><label>ÌôïÏù∏ *</label><input type="password" id="new-webpw2"></div>
            </div>

            <div class="form-row">
                <div class="form-group"><label>2Ï∞® PW *</label><input type="password" id="new-pw2" maxlength="6"></div>
                <div class="form-group"><label>ÌôïÏù∏ *</label><input type="password" id="new-pw2-confirm" maxlength="6">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group"><label>SAP PW</label><input type="password" id="new-sappw"></div>
                <div class="form-group"><label>ÌôïÏù∏</label><input type="password" id="new-sappw2"></div>
            </div>

            <div class="actions" style="margin-top: 10px;">
                <button class="primary-btn" onclick="submitNewUser()">Îì±Î°ù</button>
                <button class="secondary-btn" onclick="switchView('login')">Ï∑®ÏÜå</button>
            </div>
        </div>

    </div>

    <!-- Main Container (Hidden Initially) -->
    <div id="app-container" style="display: none;">
        <!-- Sidebar -->
        <nav id="sidebar">
            <div class="nav-top">
                <div class="menu-item active" data-target="view-daily-log" onclick="switchMainTab('view-daily-log')">
                    <span class="icon">üìÖ</span>
                    <span class="label">ÏùºÏßÄÏÉùÏÑ±</span>
                </div>
                <div class="menu-item" data-target="view-erp-check" onclick="switchMainTab('view-erp-check')">
                    <span class="icon">üìã</span>
                    <span class="label">ERPÏùºÏùºÏ†êÍ≤Ä</span>
                </div>
                <div class="menu-item" data-target="view-track-access" onclick="switchMainTab('view-track-access')">
                    <span class="icon">üöß</span>
                    <span class="label">ÏÑ†Î°úÏ∂úÏûÖÍ¥ÄÎ¶¨</span>
                </div>
                <div class="menu-item" data-target="view-vehicle-log" onclick="switchMainTab('view-vehicle-log')">
                    <span class="icon">üöó</span>
                    <span class="label">Ï∞®ÎüâÏö¥ÌñâÏùºÏßÄ</span>
                </div>
            </div>
            <div class="nav-bottom">
                <div class="menu-item settings-btn" onclick="openSettings()">
                    <span class="icon">‚öôÔ∏è</span>
                    <span class="label">ÏÑ§Ï†ï</span>
                </div>
            </div>
        </nav>

        <!-- Content Area -->
        <main id="content">
            <!-- Daily Log View -->
            <div id="view-daily-log" class="view-section active">
                <h1>ÏùºÏßÄÏÉùÏÑ±</h1>
                <div class="daily-log-container">
                    <div class="daily-log-main">
                        <!-- Left Column: Controls -->
                        <div class="left-col">
                            <div class="control-box">
                                <label>Í∑ºÎ¨¥ Ïä§ÏºÄÏ§Ñ</label>
                                <div class="option-group">
                                    <label class="radio-label">
                                        <input type="radio" name="work-type" value="day"
                                            onchange="handleWorkTypeChange()">
                                        <span>Ï£ºÍ∞Ñ</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="work-type" value="night"
                                            onchange="handleWorkTypeChange()">
                                        <span>ÏïºÍ∞Ñ</span>
                                    </label>
                                </div>
                            </div>

                            <div class="control-box expanded-box">
                                <label>ÏûêÎèôÌôî Ïã§Ìñâ Î™©Î°ù</label>
                                <div class="option-group checkbox-group vertical-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="chk-make-log">
                                        <span>ÏùºÏßÄÏÉùÏÑ±</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="chk-general" checked>
                                        <span>ÏùºÎ∞òÏóÖÎ¨¥</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="chk-safe-manage" checked>
                                        <span>ÏïàÏ†ÑÍ¥ÄÎ¶¨</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="chk-driving">
                                        <span>Ïö¥Ï†ÑÏ†ÅÌï©ÏÑ± Ï†êÍ≤ÄÌëú</span>
                                    </label>
                                </div>
                            </div>

                            <div class="control-box">
                                <label>Ï∂îÍ∞Ä ÏòµÏÖò</label>
                                <div class="option-group vertical-group">
                                    <label class="checkbox-label" id="lbl-drink">
                                        <input type="checkbox" id="chk-drink" onchange="toggleDrinkCalibration()">
                                        <span>Ï£ºÍ∞Ñ ÏùåÏ£ºÏ∏°Ï†ï</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="chk-drink-cal" disabled>
                                        <span>ÏùåÏ£ºÏ∏°Ï†ïÍ∏∞ ÍµêÏ†ï</span>
                                    </label>
                                </div>
                            </div>

                        </div>

                        <!-- Right Column: Worker List -->
                        <div class="right-col">
                            <div class="control-box" style="height: 100%;">
                                <label>Í∑ºÎ¨¥Ïûê</label>
                                <div class="worker-list-wrap"
                                    style="flex: 1; border: 1px solid #e0e0e0; border-radius: 8px; background: #fff; display: flex; flex-direction: column; overflow: hidden;">
                                    <div class="worker-list-header">
                                        <div class="wl-name">Ïù¥Î¶Ñ</div>
                                        <div class="wl-note">Ìú¥Í∞Ä/ÎπÑÍ≥†</div>
                                        <div class="wl-drive hidden-col" id="col-header-drive">Ïö¥Ï†Ñ</div>
                                    </div>
                                    <div id="daily-worker-list" class="worker-list-body">
                                        <!-- Dynamic Content -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Separate Footer for Start Button -->
                    <div class="daily-log-footer">
                        <button class="primary-btn large-btn" onclick="startDailyLog()">ÏãúÏûë</button>
                    </div>
                </div>
            </div>

            <!-- ERP Check View -->
            <div id="view-erp-check" class="view-section">
                <!-- Compact header if needed or keep h1 but less margin -->
                <h1>ERPÏùºÏùºÏ†êÍ≤Ä</h1>
                <div class="erp-container">
                    <div class="erp-compact-layout">
                        <!-- Row 1: Substation -->
                        <div class="erp-row">
                            <div class="erp-label-col">Î≥ÄÏ†ÑÏÜå</div>
                            <div class="erp-content-col">
                                <div class="erp-grid-3" id="grid-substation"></div>
                            </div>
                        </div>

                        <!-- Row 2: Electric Room -->
                        <div class="erp-row">
                            <div class="erp-label-col">Ï†ÑÍ∏∞Ïã§</div>
                            <div class="erp-content-col">
                                <div class="erp-group-container">
                                    <div class="erp-group-stack">
                                        <div class="erp-sub-header">Í∑∏Î£π 1</div>
                                        <div class="erp-btn-stack" id="elec-g1"></div>
                                    </div>
                                    <div class="erp-group-stack">
                                        <div class="erp-sub-header">Í∑∏Î£π 2</div>
                                        <div class="erp-btn-stack" id="elec-g2"></div>
                                    </div>
                                    <div class="erp-group-stack">
                                        <div class="erp-sub-header">Í∑∏Î£π 3</div>
                                        <div class="erp-btn-stack" id="elec-g3"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Row 3: Etc -->
                        <div class="erp-row">
                            <div class="erp-label-col">Í∏∞ÌÉÄÏóÖÎ¨¥</div>
                            <div class="erp-content-col">
                                <div class="erp-grid-3" id="grid-etc"></div>
                            </div>
                        </div>
                    </div>

                    <div class="erp-footer">
                        <button class="secondary-btn" id="btn-erp-mode" onclick="toggleERPMode()">ÏùºÍ¥ÑÎ™®Îìú &gt;</button>
                        <button class="primary-btn large-btn" onclick="runERPTask()">ÏãúÏûë</button>
                    </div>
                </div>
            </div>

            <!-- Track Access View -->
            <div id="view-track-access" class="view-section">
                <h1>ÏÑ†Î°úÏ∂úÏûÖÍ¥ÄÎ¶¨</h1>
                <div class="card">
                    <button class="primary-btn" onclick="runTask('TrackAccess')">ÏãúÏûë</button>
                </div>
            </div>

            <!-- Vehicle Log View -->
            <div id="view-vehicle-log" class="view-section">
                <h1>Ï∞®ÎüâÏö¥ÌñâÏùºÏßÄ</h1>
                <div class="card">
                    <!-- Placeholder -->
                    <p>Ï§ÄÎπÑ Ï§ëÏûÖÎãàÎã§.</p>
                </div>
            </div>
        </main>
    </div>

    <!-- Settings Overlay View (Hidden Initially) -->
    <div id="settings-view" style="display: none;">
        <div class="settings-header">
            <button class="back-btn" onclick="closeSettings()">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" fill="currentColor" />
                </svg>
                <span class="settings-title">ÏÑ§Ï†ï</span>
            </button>
        </div>

        <div class="settings-body">
            <!-- Settings Tabs Sidebar -->
            <div class="settings-sidebar">
                <div class="tab-item active" onclick="switchSettingsTab('tab-user')">Ïú†Ï†ÄÏ†ïÎ≥¥</div>
                <div class="tab-item" onclick="switchSettingsTab('tab-worker')">ÏûëÏóÖÏûê</div>
                <div class="tab-item" onclick="switchSettingsTab('tab-location')">ÏûëÏóÖÏû•ÏÜå</div>
                <div class="tab-item" onclick="switchSettingsTab('tab-hotkey')">Îã®Ï∂ïÌÇ§</div>
                <div class="tab-item" onclick="switchSettingsTab('tab-preset')">ÌîÑÎ¶¨ÏÖã</div>
                <div class="tab-item" onclick="switchSettingsTab('tab-updates')">ÏóÖÎç∞Ïù¥Ìä∏ ÎÇ¥Ïó≠</div>
            </div>

            <div class="settings-content-area">

                <!-- Tab 1: User Info -->
                <div id="tab-user" class="settings-tab-pane active">
                    <h2>ÎÇ¥ Ï†ïÎ≥¥</h2>
                    <div class="form-group inline-field"><label>Ïù¥Î¶Ñ</label><input type="text" id="user-name" readonly
                            disabled></div>
                    <div class="form-group inline-field"><label>ÏÇ¨Î≤à</label><input type="text" id="user-id" readonly
                            disabled></div>
                    <div class="form-group inline-field"><label>Î∂ÑÏÜå</label><input type="text" id="user-dept"></div>
                    <div class="form-group inline-field"><label>Í∑ºÎ¨¥Ï°∞</label>
                        <select id="user-team">
                            <option>AÏ°∞</option>
                            <option>BÏ°∞</option>
                            <option>CÏ°∞</option>
                            <option>DÏ°∞</option>
                            <option>ÏùºÍ∑º</option>
                        </select>
                    </div>
                    <hr>
                    <h3>ÎπÑÎ∞ÄÎ≤àÌò∏ Í¥ÄÎ¶¨</h3>
                    <div class="form-group inline-field"><label>ÌÜµÌï© PW</label><input type="password" id="user-webpw">
                    </div>
                    <div class="form-group inline-field"><label>2Ï∞® PW</label><input type="password" id="user-pw2"
                            maxlength="6"></div>
                    <div class="form-group inline-field"><label>SAP PW</label><input type="password" id="user-sappw">
                    </div>

                    <hr>

                </div>

                <!-- Tab 2: Workers -->
                <div id="tab-worker" class="settings-tab-pane">
                    <div class="tab-header">
                        <h2>Î∂ÑÏÜåÏõê</h2>
                    </div>
                    <div class="table-wrapper">
                        <table id="worker-table">
                            <thead>
                                <tr>
                                    <th width="15%">Ïù¥Î¶Ñ</th>
                                    <th width="15%">ÏÇ¨Î≤à</th>
                                    <th width="15%">Í∑ºÎ¨¥Ï°∞</th>
                                    <th width="20%">Ï†ÑÌôîÎ≤àÌò∏</th>
                                    <th width="10%">Î∂ÑÏÜåÏû•</th>
                                    <th width="15%">Ïö¥Ï†ÑÏõê</th>
                                    <th width="10%">ÏÇ≠Ï†ú</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <button class="add-row-btn" onclick="addWorkerRow()">+ Ï∂îÍ∞Ä</button>
                </div>

                <!-- Tab 3: Locations -->
                <div id="tab-location" class="settings-tab-pane">
                    <div class="tab-header">
                        <h2>ERPÏ†êÍ≤Ä</h2>
                    </div>
                    <div class="table-wrapper">
                        <table id="location-table">
                            <thead>
                                <tr>
                                    <th width="40%">Ï†êÍ≤ÄÏû•ÏÜå</th>
                                    <th width="20%">Ïò§ÎçîÎ≤àÌò∏</th>
                                    <th width="30%">Íµ¨Î∂Ñ</th>
                                    <th width="10%">ÏÇ≠Ï†ú</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <button class="add-row-btn" onclick="addLocationRow()">+ Ï∂îÍ∞Ä</button>
                </div>

                <!-- Tab 4: Hotkeys -->
                <div id="tab-hotkey" class="settings-tab-pane">
                    <h2>Îã®Ï∂ïÌÇ§ ÏÑ§Ï†ï</h2>
                    <div class="table-wrapper">
                        <table id="hotkey-table">
                            <thead>
                                <tr>
                                    <th width="30%">Í∏∞Îä•</th>
                                    <th width="25%">Îã®Ï∂ïÌÇ§</th>
                                    <th width="35%">ÏÑ§Î™Ö</th>
                                    <th width="10%" class="center">ÌôúÏÑ±</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <!-- Tab 5: Presets -->
                <div id="tab-preset" class="settings-tab-pane">
                    <h2>ÏÑ†Î°úÏ∂úÏûÖ ÌîÑÎ¶¨ÏÖã</h2>
                    <div class="form-group">
                        <label>ÌîÑÎ¶¨ÏÖã ÏÑ†ÌÉù</label>
                        <select id="preset-selector" onchange="loadPresetDetail()"></select>
                    </div>
                    <div class="form-group">
                        <label>ÌîÑÎ¶¨ÏÖã Ïù¥Î¶Ñ</label>
                        <input type="text" id="ps-name">
                    </div>
                    <div class="form-group">
                        <label>ÏûëÏóÖ ÎÇ¥Ïö©</label>
                        <textarea id="ps-work" rows="5"></textarea>
                    </div>
                    <div class="actions center"><button class="primary-btn" onclick="saveSettings()">Ï†ÄÏû•</button></div>
                </div>

                <!-- Tab 6: Update History -->
                <div id="tab-updates" class="settings-tab-pane">
                    <div class="tab-header">
                        <h2>ÏóÖÎç∞Ïù¥Ìä∏ ÎÇ¥Ïó≠</h2>
                        <button class="secondary-btn small" onclick="requestReleaseNotes()">ÏÉàÎ°úÍ≥†Ïπ®</button>
                    </div>
                    <div id="release-list" class="release-list-container">
                        <div class="loading-spinner">Î°úÎî© Ï§ë...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="app.js"></script>
</body>

</html>